{% extends "base.html" %}
{% block content %}

<div class="high1-container">

    <h1 class="high1-title">고1 입시 분석</h1>
    <p class="high1-sub">희망 학교와 학과를 선택해주세요</p>

    <div class="form-card">

        <!-- 학교 선택 -->
        <label class="label">학교 선택</label>
        <select id="school-select" class="select-box">
            <option value="">학교를 선택하세요</option>
            {% for s in schools %}
                <option value="{{ s }}">{{ s }}</option>
            {% endfor %}
        </select>

        <!-- 학과 선택 -->
        <label class="label">학과 선택</label>
        <select id="major-select" class="select-box">
            <option value="">학교를 먼저 선택하세요</option>
        </select>

        <button id="start-btn" class="submit-btn">분석 시작하기</button>

    </div>
</div>

<!-- school → major 매핑 전달 -->
<script>
    const majorMap = {{ major_map|tojson }};
    const schoolSelect = document.getElementById("school-select");
    const majorSelect = document.getElementById("major-select");
    const startBtn = document.getElementById("start-btn");

    // === 학교 선택 시 학과 리스트 갱신 ===
    schoolSelect.addEventListener("change", function () {
        const school = this.value;
        majorSelect.innerHTML = "";

        if (!school) {
            majorSelect.innerHTML = "<option>학교를 먼저 선택하세요</option>";
            return;
        }

        const majors = majorMap[school];

        majors.forEach(m => {
            const opt = document.createElement("option");
            opt.value = m;
            opt.textContent = m;
            majorSelect.appendChild(opt);
        });
    });

    // === 분석 시작하기 버튼 클릭 시 ===
    startBtn.addEventListener("click", function () {
        const school = schoolSelect.value;
        const major = majorSelect.value;

        if (!school) {
            alert("학교를 선택해주세요.");
            return;
        }
        if (!major) {
            alert("학과를 선택해주세요.");
            return;
        }

        // result_1 페이지로 이동
        window.location.href = `/result_1?school=${encodeURIComponent(school)}&major=${encodeURIComponent(major)}`;
    });
</script>

{% endblock %}
